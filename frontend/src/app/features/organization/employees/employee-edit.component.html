<app-navbar></app-navbar>
<app-sidebar></app-sidebar>

<div class="container">
  <!-- Header -->
  <div class="page-header">
    <div>
      <h1>Edit Employee</h1>
      <p>Update employee information</p>
    </div>
    <button class="btn btn-secondary" (click)="cancel()">
      ‚Üê Back to Details
    </button>
  </div>

  <!-- Form Card -->
  <div class="card">
    <form [formGroup]="employeeForm" (ngSubmit)="onSubmit()">
      
      <!-- Personal Information Section -->
      <div class="form-section">
        <h3 class="section-title">Personal Information</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="name">
              Full Name <span class="required">*</span>
            </label>
            <input 
              type="text" 
              id="name"
              class="form-control" 
              formControlName="name"
              placeholder="Enter full name"
              [class.error]="f['name'].invalid && f['name'].touched">
            
            <div class="error-message" *ngIf="f['name'].invalid && f['name'].touched">
              <span *ngIf="f['name'].errors?.['required']">Name is required</span>
              <span *ngIf="f['name'].errors?.['minlength']">Name must be at least 2 characters</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="email">
              Email Address <span class="required">*</span>
            </label>
            <input 
              type="email" 
              id="email"
              class="form-control" 
              formControlName="email"
              placeholder="employee@example.com"
              [class.error]="f['email'].invalid && f['email'].touched">
            
            <div class="error-message" *ngIf="f['email'].invalid && f['email'].touched">
              <span *ngIf="f['email'].errors?.['required']">Email is required</span>
              <span *ngIf="f['email'].errors?.['email']">Invalid email format</span>
            </div>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="phone">
              Phone Number <span class="required">*</span>
            </label>
            <input 
              type="tel" 
              id="phone"
              class="form-control" 
              formControlName="phone"
              placeholder="10-digit mobile number"
              [class.error]="f['phone'].invalid && f['phone'].touched">
            
            <div class="error-message" *ngIf="f['phone'].invalid && f['phone'].touched">
              <span *ngIf="f['phone'].errors?.['required']">Phone is required</span>
              <span *ngIf="f['phone'].errors?.['pattern']">Phone must be 10 digits</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="dateOfJoining">
              Date of Joining <span class="required">*</span>
            </label>
            <input 
              type="date" 
              id="dateOfJoining"
              class="form-control" 
              formControlName="dateOfJoining"
              [min]="minDate"
              [max]="maxDate"
              [class.error]="f['dateOfJoining'].invalid && f['dateOfJoining'].touched">
            
            <div class="error-message" *ngIf="f['dateOfJoining'].invalid && f['dateOfJoining'].touched">
              <span *ngIf="f['dateOfJoining'].errors?.['required']">Joining date is required</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="address">
            Address <span class="required">*</span>
          </label>
          <textarea 
            id="address"
            class="form-control" 
            formControlName="address"
            placeholder="Enter full address"
            rows="3"
            [class.error]="f['address'].invalid && f['address'].touched">
          </textarea>
          
          <div class="error-message" *ngIf="f['address'].invalid && f['address'].touched">
            <span *ngIf="f['address'].errors?.['required']">Address is required</span>
          </div>
        </div>
      </div>

      <!-- Employment Details Section -->
      <div class="form-section">
        <h3 class="section-title">Employment Details</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="department">
              Department <span class="required">*</span>
            </label>
            <select 
              id="department"
              class="form-control" 
              formControlName="department"
              [class.error]="f['department'].invalid && f['department'].touched">
              <option value="">Select Department</option>
              <option *ngFor="let dept of departments" [value]="dept">{{ dept }}</option>
            </select>
            
            <div class="error-message" *ngIf="f['department'].invalid && f['department'].touched">
              <span *ngIf="f['department'].errors?.['required']">Department is required</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="designation">
              Designation <span class="required">*</span>
            </label>
            <select 
              id="designation"
              class="form-control" 
              formControlName="designation"
              [class.error]="f['designation'].invalid && f['designation'].touched">
              <option value="">Select Designation</option>
              <option *ngFor="let desig of designations" [value]="desig">{{ desig }}</option>
            </select>
            
            <div class="error-message" *ngIf="f['designation'].invalid && f['designation'].touched">
              <span *ngIf="f['designation'].errors?.['required']">Designation is required</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Bank Details Section -->
      <div class="form-section">
        <h3 class="section-title">Bank Account Details</h3>
        
        <div class="form-row">
          <div class="form-group">
            <label class="form-label" for="bankName">
              Bank Name <span class="required">*</span>
            </label>
            <input 
              type="text" 
              id="bankName"
              class="form-control" 
              formControlName="bankName"
              placeholder="Enter bank name"
              [class.error]="f['bankName'].invalid && f['bankName'].touched">
            
            <div class="error-message" *ngIf="f['bankName'].invalid && f['bankName'].touched">
              <span *ngIf="f['bankName'].errors?.['required']">Bank name is required</span>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="bankAccountNumber">
              Account Number <span class="required">*</span>
            </label>
            <input 
              type="text" 
              id="bankAccountNumber"
              class="form-control" 
              formControlName="bankAccountNumber"
              placeholder="9-18 digit account number"
              [class.error]="f['bankAccountNumber'].invalid && f['bankAccountNumber'].touched">
            
            <div class="error-message" *ngIf="f['bankAccountNumber'].invalid && f['bankAccountNumber'].touched">
              <span *ngIf="f['bankAccountNumber'].errors?.['required']">Account number is required</span>
              <span *ngIf="f['bankAccountNumber'].errors?.['pattern']">Account number must be 9-18 digits</span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="ifscCode">
            IFSC Code <span class="required">*</span>
          </label>
          <input 
            type="text" 
            id="ifscCode"
            class="form-control" 
            formControlName="ifscCode"
            placeholder="e.g., SBIN0001234"
            [class.error]="f['ifscCode'].invalid && f['ifscCode'].touched"
            style="text-transform: uppercase;">
          
          <div class="error-message" *ngIf="f['ifscCode'].invalid && f['ifscCode'].touched">
            <span *ngIf="f['ifscCode'].errors?.['required']">IFSC code is required</span>
            <span *ngIf="f['ifscCode'].errors?.['pattern']">Invalid IFSC format (e.g., SBIN0001234)</span>
          </div>
          <small class="form-hint">Format: First 4 letters (bank), 5th is 0, last 6 are alphanumeric</small>
        </div>
      </div>

      <!-- Form Actions -->
      <div class="form-actions">
        <button type="button" class="btn btn-secondary" (click)="cancel()">
          Cancel
        </button>
        <button type="submit" class="btn btn-primary" [disabled]="loading">
          <span *ngIf="!loading">Update Employee</span>
          <span *ngIf="loading">Updating...</span>
        </button>
      </div>
    </form>
  </div>

  <app-loader *ngIf="loading"></app-loader>
</div>